{% extends "base.html" %}

{% block title %}Dashboard - NEET Study Tracker{% endblock %}

{% block content %}
<h1>Welcome, {{ current_user.username }}! ðŸ‘‹</h1>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 2rem 0;">
    <div class="card" style="text-align: center;">
        <h3 style="color: #2563eb;">Overall Progress</h3>
        <p style="font-size: 2.5rem; font-weight: bold; margin: 1rem 0;">{{ overall_progress }}%</p>
    </div>
    
    <div class="card" style="text-align: center;">
        <h3 style="color: #16a34a;">Study Time (This Week)</h3>
        <p style="font-size: 2.5rem; font-weight: bold; margin: 1rem 0;">{{ total_study_time_week }}h</p>
    </div>
</div>

<div class="card">
    <h2 style="margin-bottom: 1.5rem;">ðŸ“š Physics Chapters</h2>
    <div style="display: grid; gap: 0.5rem;">
        {% for chapter in physics_chapters %}
        <div style="padding: 1rem; background: #f9fafb; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
            <span>{{ chapter.chapter_name }}</span>
            <div style="display: flex; gap: 1rem;">
                <label><input type="checkbox" {% if chapter.ncert_read %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'ncert_read', this.checked)"> NCERT</label>
                <label><input type="checkbox" {% if chapter.lecture_watched %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'lecture_watched', this.checked)"> Lecture</label>
                <label><input type="checkbox" {% if chapter.questions_solved %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'questions_solved', this.checked)"> Questions</label>
                <label><input type="checkbox" {% if chapter.revised %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'revised', this.checked)"> Revised</label>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<div class="card">
    <h2 style="margin-bottom: 1.5rem;">ðŸ§ª Chemistry Chapters</h2>
    <div style="display: grid; gap: 0.5rem;">
        {% for chapter in chemistry_chapters %}
        <div style="padding: 1rem; background: #f9fafb; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
            <span>{{ chapter.chapter_name }}</span>
            <div style="display: flex; gap: 1rem;">
                <label><input type="checkbox" {% if chapter.ncert_read %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'ncert_read', this.checked)"> NCERT</label>
                <label><input type="checkbox" {% if chapter.lecture_watched %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'lecture_watched', this.checked)"> Lecture</label>
                <label><input type="checkbox" {% if chapter.questions_solved %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'questions_solved', this.checked)"> Questions</label>
                <label><input type="checkbox" {% if chapter.revised %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'revised', this.checked)"> Revised</label>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<div class="card">
    <h2 style="margin-bottom: 1.5rem;">ðŸ§¬ Biology Chapters</h2>
    <div style="display: grid; gap: 0.5rem;">
        {% for chapter in biology_chapters %}
        <div style="padding: 1rem; background: #f9fafb; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
            <span>{{ chapter.chapter_name }}</span>
            <div style="display: flex; gap: 1rem;">
                <label><input type="checkbox" {% if chapter.ncert_read %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'ncert_read', this.checked)"> NCERT</label>
                <label><input type="checkbox" {% if chapter.lecture_watched %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'lecture_watched', this.checked)"> Lecture</label>
                <label><input type="checkbox" {% if chapter.questions_solved %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'questions_solved', this.checked)"> Questions</label>
                <label><input type="checkbox" {% if chapter.revised %}checked{% endif %} onchange="updateChapter({{ chapter.id }}, 'revised', this.checked)"> Revised</label>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
function updateChapter(chapterId, field, value) {
    fetch('/update_chapter/' + chapterId, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({[field]: value})
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            location.reload();
        }
    });
}
</script>
{% endblock %}
